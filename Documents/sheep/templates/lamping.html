{% extends "base.html" %}
{% load static %}

{% block title %}
{% if form.instance.pk %}Edit Milk{% else %}Add New Milk{% endif %}
{% endblock %}

{% block page %}
<div class="container text-center">
  <div class="row">

    <!-- TABLE -->
    <div class="col-8">
      <div class="card shadow-sm">
        <div class="card-body">
          <div id="example-table"></div>
        </div>
      </div>
    </div>

    <!-- FORM -->
        <div class="col-4">
            <div class="container py-5">
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        <div class="card shadow-sm border-0">
                            <div class="card-header bg-primary text-white">
                                <h4 class="mb-0">üêë Record a Birth Event</h4>
                            </div>
                            <div class="card-body">
                                <form method="post" novalidate>
                                    {% csrf_token %}
                                    {{ form.non_field_errors }}

                                    <!-- Mother -->
                                    <div class="mb-3">
                                        <label class="form-label">{{ form.mother.label }}</label>
                                        {{ form.mother }}
                                        {% for error in form.mother.errors %}
                                            <div class="text-danger small">{{ error }}</div>
                                        {% endfor %}
                                    </div>

                                    <!-- New Lamb Names -->
                                    <div class="mb-3">
                                        <label for="new_lambs" class="form-label">New Lamb Names</label>
                                        <input 
                                            type="text" 
                                            name="new_lambs" 
                                            id="new_lambs" 
                                            class="form-control" 
                                            placeholder="e.g. Bella, Max, Luna"
                                        >
                                        <div class="form-text">Enter lamb names separated by commas.</div>
                                    </div>

                                    <!-- Date -->
                                    <div class="mb-3">
                                        <label class="form-label">{{ form.date.label }}</label>
                                        {{ form.date }}
                                        {% for error in form.date.errors %}
                                            <div class="text-danger small">{{ error }}</div>
                                        {% endfor %}
                                    </div>

                                    <div class="d-flex justify-content-end">
                                        <button type="submit" class="btn btn-primary px-4">üíæ Save Event</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
  </div>
</div>
<script>
        var table = new Tabulator("#example-table", {
    ajaxURL: "/api/birthevent/",
    layout:"fitColumns",      //fit columns to width of table
    responsiveLayout:"hide",  //hide columns that don't fit on the table
    addRowPos:"top",          //when adding a new row, add it to the top of the table
    history:true,             //allow undo and redo actions on the table
    pagination:"local",       //paginate the data
    paginationSize:10,         //allow 100 rows per page of data
    paginationCounter:"rows", //display count of paginated rows in footer
    movableColumns:true,      //allow column order to be changed
    initialSort:[             //set the initial sort order of the data
        {column:"name", dir:"asc"},
    ],
    columnDefaults:{
        tooltip:true,         //show tool tips on cells
    },
    columns:[                 //define the table columns
        {title:"Mother", field:"mother"},
        {title: "Earing", field: "earing"},
        {title: "Birthdate",field: "date", sorter:"date"},
        {title: "Lambs", field: "lambs"},
    ],
    });
</script>





{% endblock %}
